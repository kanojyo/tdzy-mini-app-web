webpackJsonp([3],{"L/lz":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),i=a.n(s),n=a("exGp"),l=a.n(n),r=a("Dd8w"),c=a.n(r),o=a("NYxO"),d=a("3/Li"),u=a("JGDk"),p=a("mfOW"),h={data:function(){return{params:{status:"",admin:"",account:"",created_at_begin:"",created_at_end:"",updated_at_begin:"",updated_at_end:"",page:1,pagesize:30},created:"",updated:"",count:0,list:[],title:"",dialogVisible:!1,formLabelAlign:{id:"",content:"",image:[]},fileList:[],uploadUrl:Object(u.a)(),status:[{type:1,value:"待处理"},{type:2,value:"待反馈"},{type:3,value:"已反馈"},{type:4,value:"已结束"}],detailsData:"",content:[],imgArr:[],carouselShow:!1,carouselArray:[],carouselIndex:0,menuData:[]}},computed:Object(o.c)({menu:function(t){return t.login.menu}}),mounted:function(){this.index(),this.menuGet()},methods:c()({},Object(o.b)({getMenu:"getMenu"}),{menuGet:function(){var t=this;this.menu.forEach(function(e){"运营"==e.name&&e.data.forEach(function(e){"/Operate/Complaint"==e.route_web&&(t.menuData=e.role_arr)})})},index:function(){var t=this;return l()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(d.g)(t.params);case 2:200===(a=e.sent).code&&(t.list=a.data.list,t.count=a.data.total);case 4:case"end":return e.stop()}},e,t)}))()},handleCurrentChange:function(t){this.params.page=t,this.index()},handleSizeChange:function(t){this.params.pagesize=t,this.index()},handleSuccess:function(t){200===t.code&&this.imgWidthHeight(t.data.url)},handleRemove:function(t,e){var a=this;this.formLabelAlign.image=[],this.fileList=[],e.forEach(function(t){a.imgWidthHeight(t.url)})},beforeAvatarUpload:function(t){if(t.size/1e3/1024>4)return this.$message({message:"图片大于4M，请重新上传~",type:"warning"}),!1},imgWidthHeight:function(t){var e=this,a=new Image;a.src=t,a.onload=function(){e.imgArr[0]=a.width,e.imgArr[1]=a.height,e.formLabelAlign.image.push({url:t,width:e.imgArr[0],height:e.imgArr[1]}),e.fileList.push({name:"",url:t})}},complaintGet:function(t){var e=this;return l()(i.a.mark(function a(){var s;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(d.h)({id:t});case 2:200===(s=a.sent).code&&(e.detailsData=s.data,e.content=s.data.content);case 4:case"end":return a.stop()}},a,e)}))()},detailsChange:function(t,e){this.title=1===e?"记录":"处理",this.formLabelAlign.id=t,this.formLabelAlign.content="",this.formLabelAlign.image=[],this.fileList=[],this.complaintGet(t),this.dialogVisible=!0},handleClose:function(){var t=this;return l()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(""!=t.formLabelAlign.content||""!=t.formLabelAlign.image){e.next=3;break}return t.$message({message:"请输入反馈问题或者反馈图片",type:"warning"}),e.abrupt("return");case 3:return e.next=5,Object(d.i)(t.formLabelAlign);case 5:200===(a=e.sent).code&&(t.dialogVisible=!1,t.index(),t.$message({message:a.data.msg,type:"success"}));case 7:case"end":return e.stop()}},e,t)}))()},search:function(){null===this.created?(this.params.created_at_begin="",this.params.created_at_end=""):(this.params.created_at_begin=this.created[0],this.params.created_at_end=this.created[1]),null===this.updated?(this.params.updated_at_begin="",this.params.updated_at_end=""):(this.params.updated_at_begin=this.updated[0],this.params.updated_at_end=this.updated[1]),this.params.page=1,this.index()},empty:function(){this.created="",this.updated="",this.params={status:"",admin:"",account:"",created_at_begin:"",created_at_end:"",updated_at_begin:"",updated_at_end:"",page:1,pagesize:30},this.index(this.params)},closeChange:function(t){var e=this;this.$confirm("此操作将关闭投诉记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.f)({id:t}).then(function(t){200===t.code&&(e.index(),e.$message({message:t.data.msg,type:"success"}))})}).catch(function(){e.$message({type:"info",message:"已取消操作~"})})},imgChange:function(t,e){this.carouselShow=!0,this.carouselArray=t,this.carouselIndex=Number(e)},iconChange:function(t){this.carouselShow=t}}),components:{Carousel:p.a}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("div",{staticClass:"operation"},[a("div",{staticClass:"pull-left"},[a("div",{staticClass:"input"},[a("el-input",{attrs:{clearable:"",size:"mini",placeholder:"管理员账号"},model:{value:t.params.admin,callback:function(e){t.$set(t.params,"admin",e)},expression:"params.admin"}})],1),t._v(" "),a("div",{staticClass:"input"},[a("el-input",{attrs:{clearable:"",size:"mini",placeholder:"用户昵称"},model:{value:t.params.account,callback:function(e){t.$set(t.params,"account",e)},expression:"params.account"}})],1),t._v(" "),a("div",{staticClass:"input"},[a("el-select",{attrs:{clearable:"",size:"mini",placeholder:"处理状态"},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.status,function(t){return a("el-option",{key:t.type,attrs:{label:t.value,value:t.type}})}))],1),t._v(" "),a("div",{staticClass:"input"},[a("el-date-picker",{attrs:{size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"登记开始日期","end-placeholder":"登记结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.created,callback:function(e){t.created=e},expression:"created"}})],1),t._v(" "),a("div",{staticClass:"input"},[a("el-date-picker",{attrs:{size:"mini",type:"datetimerange","range-separator":"至","start-placeholder":"处理开始日期","end-placeholder":"处理结束日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.updated,callback:function(e){t.updated=e},expression:"updated"}})],1),t._v(" "),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search",type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询结果")])],1),t._v(" "),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-delete",type:"primary",size:"mini"},on:{click:t.empty}},[t._v("清空删选条件")])],1)])]),t._v(" "),a("div",{staticClass:"table"},[a("div",{staticClass:"table-list"},[a("el-table",{attrs:{data:t.list,border:"",height:"700","header-cell-style":{background:"#f3f3f3"}}},[a("el-table-column",{attrs:{align:"center",prop:"id",label:"投诉编号"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"account",label:"用户昵称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"status",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[1===e.row.status?a("span",[t._v("待处理")]):t._e(),t._v(" "),2===e.row.status?a("span",[t._v("待反馈")]):t._e(),t._v(" "),3===e.row.status?a("span",[t._v("已反馈")]):t._e(),t._v(" "),4===e.row.status?a("span",[t._v("已结束")]):t._e()])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间",width:"180px"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"updated_at",label:"最后处理时间",width:"180px"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"admin",label:"管理员"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[4!==e.row.status&&t.menuData.process?a("span",{staticClass:"cursor color-f8494c",on:{click:function(a){t.detailsChange(e.row.id,2)}}},[t._v("处理")]):t._e(),t._v(" \n              "),t.menuData.details?a("span",{staticClass:"cursor color-f8494c",on:{click:function(a){t.detailsChange(e.row.id,1)}}},[t._v("详情")]):t._e(),t._v(" \n              "),2===e.row.close&&t.menuData.close?a("span",{staticClass:"cursor color_red",on:{click:function(a){t.closeChange(e.row.id)}}},[t._v("关闭")]):t._e()])]}}])})],1)],1),t._v(" "),a("div",{staticClass:"table-peg"},[a("div",{staticClass:"pull-left"}),t._v(" "),a("div",{staticClass:"pull-right"},[a("el-pagination",{attrs:{"current-page":t.params.page,"page-sizes":[30,50,100],"page-size":t.params.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.count},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])]),t._v(" "),a("el-dialog",{attrs:{title:"投诉"+t.title,visible:t.dialogVisible,width:"1080px","close-on-click-modal":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"details"},[a("div",{staticClass:"title"},[t._v("基本信息")]),t._v(" "),a("table",{staticClass:"ajun-table"},[a("tr",[a("td",[t._v("状态")]),t._v(" "),a("td",[t._v("用户账号")]),t._v(" "),a("td",[t._v("创建时间")]),t._v(" "),a("td",[t._v("管理员")])]),t._v(" "),a("tr",[1===t.detailsData.status?a("td",[t._v("待处理")]):t._e(),t._v(" "),2===t.detailsData.status?a("td",[t._v("待反馈")]):t._e(),t._v(" "),3===t.detailsData.status?a("td",[t._v("已反馈")]):t._e(),t._v(" "),4===t.detailsData.status?a("td",[t._v("已结束")]):t._e(),t._v(" "),a("td",[t._v(t._s(t.detailsData.account))]),t._v(" "),a("td",[t._v(t._s(t.detailsData.created_at))]),t._v(" "),a("td",[t._v(t._s(t.detailsData.admin))])])])]),t._v(" "),a("div",{staticClass:"feedback"},[a("ul",{staticClass:"list"},t._l(t.content,function(e,s){return a("li",{key:s,staticClass:"item"},[1===e.type?a("div",{staticClass:"title"},[t._v(t._s(t.detailsData.account))]):a("div",{staticClass:"title"},[t._v(t._s(t.detailsData.admin))]),t._v(" "),a("div",{staticClass:"img-list"},[a("div",{staticClass:"content"},[t._v(t._s(e.content))]),t._v(" "),a("div",{staticClass:"img"},t._l(e.image,function(s,i){return a("img",{key:i,attrs:{src:s.url,alt:""},on:{click:function(a){t.imgChange(e.image,i)}}})})),t._v(" "),a("div",{staticClass:"time"},[t._v(t._s(e.created_at))])])])}))]),t._v(" "),"处理"===t.title&&t.content.length>0?a("div",{staticClass:"from"},[a("el-form",{attrs:{"label-width":"150px",model:t.formLabelAlign}},[a("el-form-item",{attrs:{label:"反馈问题"}},[a("el-input",{attrs:{type:"textarea",rows:3,clearable:"",placeholder:"请输入反馈问题"},model:{value:t.formLabelAlign.content,callback:function(e){t.$set(t.formLabelAlign,"content",e)},expression:"formLabelAlign.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"反馈图片"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:t.uploadUrl,"on-success":t.handleSuccess,"on-remove":t.handleRemove,"file-list":t.fileList,beforeUpload:t.beforeAvatarUpload,limit:"6","list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("图片最多上传6张")])],1)],1)],1)],1):t._e(),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),"处理"===t.title?a("el-button",{attrs:{type:"primary"},on:{click:t.handleClose}},[t._v("确 定")]):t._e()],1)]),t._v(" "),a("transition",{attrs:{name:"el-fade-in-linear"}},[t.carouselShow?a("Carousel",{attrs:{carouselArray:t.carouselArray,carouselIndex:t.carouselIndex,carouselShow:t.carouselShow},on:{iconChange:t.iconChange}}):t._e()],1)],1)},staticRenderFns:[]};var v=a("VU/8")(h,m,!1,function(t){a("rko9")},"data-v-027bbbad",null);e.default=v.exports},SN0V:function(t,e){},mfOW:function(t,e,a){"use strict";var s={name:"carousel",data:function(){return{height:"",scrollHeight:document.body.scrollHeight}},props:{carouselArray:{type:Array},carouselIndex:{type:Number},carouselShow:{type:Boolean}},mounted:function(){var t=this;this.carouselArray.forEach(function(e,a){e.i=t.scrollHeight/e.height,e.height>t.scrollHeight&&(e.height=t.scrollHeight,e.width=e.width*e.i),t.height=t.height>e.height?t.height:e.height+"px"})},methods:{iconChange:function(){this.$emit("iconChange",!1)}}},i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"model"},[e("div",{staticClass:"icon",on:{click:this.iconChange}},[e("i",{staticClass:"el-icon-close"})]),this._v(" "),e("el-carousel",{attrs:{"initial-index":this.carouselIndex,autoplay:!1,height:this.height}},this._l(this.carouselArray,function(t,a){return e("el-carousel-item",{key:a},[e("div",{style:"width: "+t.width+"px;max-width: 980px; margin: 0 auto;position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);"},[e("img",{attrs:{src:t.url,alt:""}})])])}))],1)},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("SN0V")},"data-v-492ac139",null);e.a=n.exports},rko9:function(t,e){}});